<?xml version="1.0" encoding="UTF-8"?>

<launch>

	<arg name="description" default="following_real_vehicle_rl0705"/>
	
	<arg name="margin" default="30.0"/>
	<arg name="use_margin" default="false"/>
	<arg name="SPEED_SCALE" default="40.0"/>	
	<arg name="HEADWAY_SCALE" default="100.0"/>
	<arg name="enable_fs" default="false"/>
	<arg name="hwil" default="false"/>

	<param name="/margin" value="$(arg margin)"/>
	<arg name="/SPEED_SCALE" default="$(arg SPEED_SCALE)"/>	
	<arg name="/HEADWAY_SCALE" default="$(arg HEADWAY_SCALE)"/>	
	<param name="description" value="$(arg description)"/>

	<node pkg="can_to_ros" type ="subs_fs" name="subs_fs" output="screen" /> 

	<node pkg="can_to_ros" type="lead_info" name="lead_info" output="screen" />

	<node pkg="can_to_ros" type="node_status.py" name="node_status" output="screen" />
	
	<!--group ns="catvehicle"-->
	<node pkg="margin" type="margin_node" name="margin_node" output="screen" if="$(arg use_margin)">
	
	</node>
	<node pkg="trajectory_07_05_2021_real" type="trajectory_07_05_2021_real_node" name="trajectory_07_05_2021_real_node" output="screen">	
		<remap from="lead_dist" to="effective_lead_dist" if="$(arg use_margin)"/>
		<remap from="cmd_vel" to="v_ref" if="$(arg enable_fs)"/>
	</node>	

	<node pkg="followerstoppermax4rl" type="followerstoppermax4rl_node" name="followerstoppermax4rl_node" output="screen" if="$(arg enable_fs)">
                <remap from="lead_dist" to="effective_lead_dist" if="$(arg use_margin)"/>
        </node>	

	<node pkg="velocity_controller" type="velocity_controller_node" name="velocity_controller_node" output="screen" if="$(arg hwil)">	
		<remap from="/vehicle/vel" to="/vel"/>	
	</node>
	
	<node pkg="can_to_ros" type ="rosbag_record.sh" name="bashscript2" output="screen" args="$(arg description)" /> 

	<node pkg="transfer_pkg" type="saveparam.py" name="saveparam" output="screen">
	</node>
	

</launch>
